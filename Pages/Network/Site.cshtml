@page "{id:int}"
@model VONetData.Pages.Network.SiteModel
@{
    ViewData["Title"] = "Site";
}
<a href="/Network" class="text-sm text-blue-700 hover:underline">? Back</a>
@if (Model.Site == null)
{
    <div class="mt-4 text-gray-600">Not found.</div>
}
else
{
    <h2 class="text-2xl font-bold mt-4 mb-4">@Model.Site.Name (@Model.Site.Type)</h2>
    <div class="grid md:grid-cols-3 gap-6">
        <div class="md:col-span-2 space-y-4">
            <div class="border bg-white rounded p-4">
                <h3 class="font-semibold mb-2">Details</h3>
                <div class="text-sm">Description: @Model.Site.Description</div>
                <div class="text-sm">Address: @Model.Site.Address</div>
                <div class="text-sm">Lat/Lon: @Model.Site.Latitude , @Model.Site.Longitude</div>
            </div>
            <div class="border bg-white rounded p-4">
                <h3 class="font-semibold mb-2">Edit</h3>
                <form method="post" asp-page-handler="Update">
                    <div class="grid md:grid-cols-2 gap-4 text-sm">
                        <div>
                            <label class="block text-xs font-semibold">Name</label>
                            <input name="Name" value="@Model.Site.Name" class="border rounded w-full px-2 py-1" />
                        </div>
                        <div>
                            <label class="block text-xs font-semibold">Type</label>
                            <select name="Type" class="border rounded w-full px-2 py-1" value="@Model.Site.Type">
                                <option value="supernode" selected="@(Model.Site.Type=="supernode")">Supernode</option>
                                <option value="node" selected="@(Model.Site.Type=="node")">Node</option>
                                <option value="candidate" selected="@(Model.Site.Type=="candidate")">Candidate</option>
                            </select>
                        </div>
                        <div class="md:col-span-2">
                            <label class="block text-xs font-semibold">Description</label>
                            <textarea name="Description" rows="3" class="border rounded w-full px-2 py-1">@Model.Site.Description</textarea>
                        </div>
                        <div>
                            <label class="block text-xs font-semibold">Latitude</label>
                            <input name="Latitude" value="@Model.Site.Latitude" class="border rounded w-full px-2 py-1" />
                        </div>
                        <div>
                            <label class="block text-xs font-semibold">Longitude</label>
                            <input name="Longitude" value="@Model.Site.Longitude" class="border rounded w-full px-2 py-1" />
                        </div>
                        <div class="md:col-span-2">
                            <label class="block text-xs font-semibold">Address</label>
                            <input name="Address" value="@Model.Site.Address" class="border rounded w-full px-2 py-1" />
                        </div>
                    </div>
                    <button class="mt-4 bg-blue-700 text-white px-4 py-2 rounded text-sm">Save Changes</button>
                </form>
            </div>
        </div>
        <div class="space-y-4">
            <div class="border bg-white rounded p-4">
                <h3 class="font-semibold mb-2">Links</h3>
                @if (Model.Links.Count == 0)
                {
                    <div class="text-xs text-gray-500">No links.</div>
                }
                else
                {
                    <ul class="text-xs space-y-1">
                        @foreach (var l in Model.Links)
                        {
                            <li>? @l.ToSiteId (@l.Medium) @l.DistanceKm km</li>
                        }
                    </ul>
                }
                <form method="post" class="mt-3 space-y-2" asp-page-handler="AddLink">
                    <div class="grid grid-cols-2 gap-2 text-xs">
                        <input name="ToSiteId" placeholder="To Site Id" class="border rounded px-2 py-1" />
                        <input name="Medium" placeholder="Medium" class="border rounded px-2 py-1" />
                        <input name="DistanceKm" placeholder="Km" class="border rounded px-2 py-1" />
                    </div>
                    <button class="bg-blue-600 text-white px-3 py-1 rounded text-xs">Add Link</button>
                </form>
            </div>
            <form method="post" asp-page-handler="Delete" onsubmit="return confirm('Delete site?');" class="border bg-white rounded p-4">
                <button class="text-red-600 text-xs hover:underline">Delete Site</button>
            </form>
        </div>
    </div>
}